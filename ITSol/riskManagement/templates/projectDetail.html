<!DOCTYPE html>
<html>
    <head>
        {% include 'head.html' %}
    </head>
    <body>
        {% include 'nav.html' %}        

        <h2>Stav projektu: {{ project.state }}</h2>

        <!-- Admin and project manager can change state of the project -->
        {% if is_user_authorized and is_editable %}
            <form action="changeProjectState/{{ projectId }}" method="post" style="margin-left: 20px;">
                {% csrf_token %}
                <div style="display: flex;">
                    <div>
                        <select name="state">
                            <option>New</option>
                            <option>In progress</option>
                            <option>Closed</option>
                            <option>Canceled</option>
                        </select>
                    </div>
                    <div>
                        <input type="submit" value="Zmenit stav">
                    </div>
                </div>
            </form>
        {% endif %}

        <h2>U≈æivatel√© zapojen√≠ do projektu {{ project.name }}</h2>

        <table>
            <tr>
                <th>ID</th>
                <th>Jm√©no</th>
                <th>Opr√°vnƒõn√≠</th>
                {% if is_user_authorized and is_editable %}
                    <th></th>
                    <th></th>
                {% endif %}
            </tr>
            {% for x in users %}
                <tr>
                    <th>{{ x.id }}</th>
                    <td>{{ x.firstName }} {{ x.lastName }}</td>
                    <td>{{ x.privileges }}</td>
                    {% if is_user_authorized and is_editable %}
                        <td class="center"><a href="removeUserFromProject/{{ x.id }}/{{ projectId }}">‚ùå</a></td>
                        <td class="center" style="width: 150px;"><a href="addUserToPhase/{{ x.id }}/{{ projectId }}">‚ûï (p≈ôidat f√°zy)</a></td>
                    {% endif %}
                </tr>
            {% endfor %}
        </table>

        {% if is_user_authorized and is_editable %}
            <form action="addUserToProject/{{ projectId }}" method="post" style="margin-left: 20px;">
                {% csrf_token %}
                <div style="display: flex;">
                    <div>
                        <input type="text" name="login" placeholder="login">
                    </div>
                    <div>
                        <input type="submit" value="P≈ôidat ƒçlena">
                    </div>
                </div>
            </form>
        {% endif %}
        
        <h2>F√°ze projektu {{ project.name }}</h2>
        <table>
            <tr>
                <th>ID</th>
                <th>N√°zev</th>
                <th>Popis</th>
                <th>Poƒçet rizik</th>
                <th>Poƒçet pracovn√≠k≈Ø</th>
                <th></th>
                {% if is_user_authorized and is_editable %}
                    <th></th>
                    <th></th>
                {% endif %}
            </tr>
            {% for x in phases %}
                <tr>
                    <th>{{ x.id }}</th>
                    <td>{{ x.name }}</td>
                    <td>{{ x.description }}</td> 
                    <td>TODO</td>
                    <td>{{ x.participants.all.count }}</td>
                    <td class="center"><a href="phaseDetail/{{ projectId }}/{{ x.id }}">üîé</a></td>
                    {% if is_user_authorized and is_editable %}
                        <td class="center"><a href="editPhase/{{ x.id }}/{{ projectId }}">‚úèÔ∏è</a></td>
                        <td class="center"><a href="removePhase/{{ x.id }}/{{projectId }}">üóëÔ∏è</a></td>
                    {% endif %}
                </tr>
            {% endfor %}
        </table>

        {% if is_user_authorized and is_editable %}
            <a class="button" href="addPhase/{{projectId}}">P≈ôidat f√°zi</a>
        {% endif %}

    </body>
</html>

